webpackJsonp([98],{YnPR:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=s("0xDb"),i=s("vMJZ"),n={name:"UserSetting",data:function(){return{phone:"",name:"",showFlag:!1,email:"",action:1,oldpwd:"",newpwd:"",surepwd:""}},activated:function(){var t=this;this.$showLoading(),document.title="设置",this.$store.ready(function(e){1==e.isLogin&&(t.phone=e.userInfo.mobile,t.email=e.userInfo.email,t.name=e.userInfo.name),t.$hideLoading()})},deactivated:function(){this.showFlag=!1},methods:{sure:function(){1==this.action?this.confirm():this.cp()},confirm:function(){var t=this;return""==this.name?(this.$toast("请输入昵称"),!1):""==this.phone?(this.$toast("请输入手机号"),!1):(this.$showLoading(),void Object(i.N)({email:this.email,mobile:this.phone,name:this.name,type:1}).then(function(e){"success"===e.result&&t.$store.dispatch("updateUserInfo").then(function(){t.$hideLoading(),t.$toast("修改成功","success"),t.showFlag=!1})}))},loginout:function(){var t=this;this.$confirm("确认退出吗？").then(function(){t.$showLoading("正在退出"),Object(i.E)().then(function(e){t.$toast("退出成功","success"),t.$store.dispatch("updateUserInfo").then(function(){t.$hideLoading(),t.$navigateBack()})})})},showbox:function(t){this.action=t,this.showFlag=!0},cp:function(){var t=this;""!=this.oldpwd&&""!=this.newpwd&&""!=this.surepwd?this.newpwd==this.surepwd?Object(i.N)({oldpwd:this.oldpwd,newpwd:this.newpwd,type:2}).then(function(e){"success"==e.result?(t.showFlag=!1,t.$store.dispatch("updateUserInfo").then(function(){t.$toast("修改成功","success").then(function(){t.$router.push({name:"UserLogin"})})})):t.$toast(e.msg)}):this.$toast("修改密码不一致"):this.$toast("内容不能为空")},changeAvatar:function(){this.$refs.file_avatar.click()},uploadAvatar:function(t){var e=this;this.$showLoading(),Object(a.b)(this.$refs.file_avatar.files[0],{w:480,h:480}).then(function(t){var s=new FormData;s.append("file",t),Object(i.d)(s).then(function(t){"success"===t.result&&e.$store.dispatch("updateUserInfo").then(function(){e.$hideLoading()})})})}}},o={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"user-setting"},[s("ks-list",{attrs:{"item-height":"49px"}},[s("ks-list-item",{attrs:{title:"头像","show-arrow":""},on:{click:t.changeAvatar}},[s("input",{ref:"file_avatar",staticClass:"ks-none",attrs:{type:"file"},on:{change:t.uploadAvatar}}),t._v(" "),s("ks-create-bg",{staticClass:"user-image",attrs:{type:"user",src:t.$store.state.userInfo.headimg,tpye:"user"}})],1)],1),t._v(" "),s("ks-list",{staticClass:"ks-pt10",attrs:{"item-height":"49px"}},[s("ks-list-item",{attrs:{title:"昵称"}},[t._v(t._s(t.$store.state.userInfo.name||"暂无"))]),t._v(" "),s("ks-list-item",{attrs:{title:"手机号"}},[t._v(t._s(t.$store.state.userInfo.mobile||"未填写"))]),t._v(" "),s("ks-list-item",{attrs:{title:"账号"}},[t._v(t._s(t.$store.state.userInfo.username||"暂无"))]),t._v(" "),s("ks-list-item",{attrs:{title:"密码"}},[t._v("\n      ******\n      "),s("span",{staticClass:"user-updata",on:{click:function(e){return t.showbox(2)}}},[t._v("点击修改")])]),t._v(" "),s("ks-list-item",{attrs:{title:"邮箱"}},[t._v(t._s(t.$store.state.userInfo.email||"未填写"))])],1),t._v(" "),s("div",{staticClass:"user-btn-box"},[s("div",{staticClass:"btn",on:{click:function(e){return t.showbox(1)}}},[t._v("修改资料")]),t._v(" "),s("div",{staticClass:"btn btn-lgout",on:{click:t.loginout}},[t._v("退出登录")])]),t._v(" "),s("ks-dialog",{attrs:{title:1==t.action?"修改资料":2==t.action&&"修改密码",visible:t.showFlag},on:{"update:visible":function(e){t.showFlag=e}}},[1==t.action?s("ks-form",{attrs:{"label-width":"80px"}},[s("ks-form-item",{attrs:{label:"昵称"}},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.name,expression:"name"}],staticClass:"ks-input",attrs:{type:"text",placeholder:"请输入昵称"},domProps:{value:t.name},on:{input:function(e){e.target.composing||(t.name=e.target.value)}}})]),t._v(" "),s("ks-form-item",{attrs:{label:"手机号"}},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.phone,expression:"phone"}],staticClass:"ks-input",attrs:{type:"number",placeholder:"请输入手机号码"},domProps:{value:t.phone},on:{input:function(e){e.target.composing||(t.phone=e.target.value)}}})]),t._v(" "),s("ks-form-item",{attrs:{label:"邮箱"}},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.email,expression:"email"}],staticClass:"ks-input",attrs:{type:"text",placeholder:"请输入邮箱"},domProps:{value:t.email},on:{input:function(e){e.target.composing||(t.email=e.target.value)}}})])],1):t._e(),t._v(" "),2==t.action?s("ks-form",{attrs:{"label-width":"80px"}},[s("ks-form-item",{attrs:{label:"旧密码"}},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.oldpwd,expression:"oldpwd"}],staticClass:"ks-input",attrs:{type:"password",autocomplete:"off",placeholder:"请输入旧密码"},domProps:{value:t.oldpwd},on:{input:function(e){e.target.composing||(t.oldpwd=e.target.value)}}})]),t._v(" "),s("ks-form-item",{attrs:{label:"新密码"}},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.newpwd,expression:"newpwd"}],staticClass:"ks-input",attrs:{type:"password",autocomplete:"off",placeholder:"请输入新密码"},domProps:{value:t.newpwd},on:{input:function(e){e.target.composing||(t.newpwd=e.target.value)}}})]),t._v(" "),s("ks-form-item",{attrs:{label:"确认新密码"}},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.surepwd,expression:"surepwd"}],staticClass:"ks-input",attrs:{type:"password",autocomplete:"off",placeholder:"重复输入新密码"},domProps:{value:t.surepwd},on:{input:function(e){e.target.composing||(t.surepwd=e.target.value)}}})])],1):t._e(),t._v(" "),s("div",{staticClass:"confirm-btn-wrap"},[s("ks-button",{attrs:{size:"medium"},on:{click:function(e){t.showFlag=!1}}},[t._v("取消")]),t._v(" "),s("ks-button",{staticClass:"ks-ml10",attrs:{size:"medium",type:"primary"},on:{click:t.sure}},[t._v("确定")])],1)],1),t._v(" "),s("store-footer")],1)},staticRenderFns:[]};var r=s("C7Lr")(n,o,!1,function(t){s("hql2")},"data-v-16f1627f",null);e.default=r.exports},hql2:function(t,e){}});