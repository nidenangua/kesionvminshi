webpackJsonp([86],{vcnn:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=s("ZLEe"),a=s.n(i),c=s("h0S9"),r=s("0xDb"),n=s("Llv5"),o=[],l={name:"CourseList",data:function(){return{sql_between:[],rangemin:"",rangemix:"",isFirstLoad:!0,loaded:!1,pageCount:null,filterType:"",rangeType:-1,courseType:-1,chargeType:-1,p:1,categoryName:"",parentActive:0,parentCategorys:[],childActive:0,childCategorys:[],sunActive:0,sunCategorys:[],list:[]}},watch:{"$route.query":{handler:function(){"CourseList"===this.$route.name&&this.getList()},deep:!0}},mounted:function(){var e=this;Object(c.a)().then(function(t){e.parentCategorys=t,e.addCategory(t),e.setCategory(e.$route.query.categoryid),e.getList()})},activated:function(){var e=this.$route.query.name;document.title=e||"发现",this.courseType=this.$route.query.courseType||this.$route.query.coursetype,this.chargeType=this.$route.query.chargetype},methods:{onrange:function(e){1==e?(this.rangemin="0",this.rangemix="99"):2==e?(this.rangemin="100",this.rangemix="199"):3==e?(this.rangemin="200",this.rangemix=""):(this.rangemin="",this.rangemix="")},addCategory:function(e,t){var s=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;e.map(function(e){t&&(e.parent=t),e.level=i,o.push(e),e.child&&i<2&&s.addCategory(e.child,e,i+1)})},filter:function(e){var t=Object(r.a)(this.$route.query);a()(e).map(function(s){t[s]=e[s]}),this.$router.push({name:this.$route.name,query:t}),this.filterType=""},setCategory:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,s=arguments[1];0==t?(this.parentActive=0,this.childActive=0,this.childCategorys=[],this.sunActive=0,this.sunCategorys=[],this.categoryName="全部课程",this.filter({categoryid:"0"})):o.map(function(i){i.categoryid==t&&(0===i.level?(e.parentActive=i.categoryid,e.childActive=i.categoryid,e.childCategorys=i.child||[],e.sunActive=0,e.sunCategorys=[]):1===i.level?(e.parentActive=i.parent.categoryid,e.childCategorys=i.parent.child,e.childActive=i.categoryid,e.sunActive=i.categoryid,e.sunCategorys=i.child||[]):2===i.level&&(e.parentActive=i.parent.parent.categoryid,e.childCategorys=i.parent.parent.child,e.childActive=i.parent.categoryid,e.sunActive=i.categoryid,e.sunCategorys=i.parent.child),(!i.child||s||2===i.level||e.isFirstLoad)&&(e.categoryName=i.categoryname,e.filter({categoryid:i.categoryid})))})},getList:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.$showLoading(),this.p=t;var s={act:"appCourse",callKeyName:"courseList",p:t,data:{},maxperpage:10},i=this.$route.query.key;s.data.sql_or_like={title:i},this.$route.query.categoryid>0&&(s.data.categoryid=this.$route.query.categoryid),2==this.$route.query.order?s.data.sql_order={studentcount:"desc"}:3==this.$route.query.order?s.data.sql_order={price:"asc"}:4==this.$route.query.order&&(s.data.sql_order={price:"desc"}),s.data.sql_between={price:this.$route.query.sql_between},this.$route.query.chargetype>=0&&(0==this.$route.query.chargetype?s.data.chargetype=[0,2]:s.data.chargetype=this.$route.query.chargetype),(this.$route.query.coursetype>0||this.$route.query.courseType>0)&&(s.data.courseType=this.$route.query.coursetype||this.$route.query.courseType),Object(n.a)([s]).then(function(s){var i=s.courseList;e.pageCount=i.page.total_pages,e.list=1==t?i.list:e.list.concat(i.list),e.loaded=!0,e.isFirstLoad=!1,e.$hideLoading()})}}},y={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"page",class:"page--style"+e.$store.state.style.id},[4==e.$store.state.style.id||5==e.$store.state.style.id?s("div",{staticClass:"page-header",on:{click:function(t){e.filterType=""}}},[s("kd-big-title",{attrs:{title:"课程","show-search":""}})],1):s("div",{staticClass:"search",on:{click:function(t){e.filterType=""}}},[s("kd-search")],1),e._v(" "),s("div",{staticClass:"filter"},[s("div",{staticClass:"filter-header ks-row ks-line"},[s("div",{staticClass:"ks-col-8",class:"sort"===e.filterType&&"active",on:{click:function(t){e.filterType="sort"===e.filterType?"":"sort"}}},[e._v("\n        "+e._s((2==e.$route.query.order?"人气排序":3==e.$route.query.order&&"价格最低")||4==e.$route.query.order&&"价格最高"||"最新排序")+"\n        "),s("i",{staticClass:"ks-icon ks-icon-chevron-down"})]),e._v(" "),s("div",{staticClass:"ks-col-8",class:"classify"===e.filterType&&"active",on:{click:function(t){e.filterType="classify"===e.filterType?"":"classify"}}},[e._v("\n        "+e._s(e.categoryName)+"\n        "),s("i",{staticClass:"ks-icon ks-icon-chevron-down"})]),e._v(" "),s("div",{staticClass:"ks-col-8",class:"types"===e.filterType&&"active",on:{click:function(t){e.filterType="types"===e.filterType?"":"types"}}},[e._v("\n        筛选\n        "),s("i",{staticClass:"ks-icon ks-icon-funnel-outline"})])]),e._v(" "),s("transition",{attrs:{name:"fade-up"}},["sort"===e.filterType?s("div",{staticClass:"filter-box"},[s("div",{staticClass:"filter-classify__item",on:{click:function(t){return e.filter({order:"1"})}}},[e._v("最新排序")]),e._v(" "),s("div",{staticClass:"filter-classify__item",on:{click:function(t){return e.filter({order:"2"})}}},[e._v("人气排序")]),e._v(" "),s("div",{staticClass:"filter-classify__item",on:{click:function(t){return e.filter({order:"3"})}}},[e._v("价格最低")]),e._v(" "),s("div",{staticClass:"filter-classify__item",on:{click:function(t){return e.filter({order:"4"})}}},[e._v("价格最高")])]):"classify"===e.filterType?s("div",{staticClass:"filter-box"},[s("div",{staticClass:"filter-classify ks-row"},[s("div",{staticClass:"ks-col-8"},[s("div",{staticClass:"filter-classify__item",class:0==e.parentActive&&"active",on:{click:function(t){return e.setCategory("0")}}},[e._v("全部")]),e._v(" "),e._l(e.parentCategorys,function(t){return s("div",{key:t.categoryid,staticClass:"filter-classify__item",class:e.parentActive==t.categoryid&&"active",on:{click:function(s){return e.setCategory(t.categoryid)}}},[e._v(e._s(t.categoryname))])})],2),e._v(" "),s("div",{staticClass:"ks-col-8"},[e.childCategorys.length?s("div",[s("div",{staticClass:"filter-classify__item",class:e.childActive==e.parentActive&&"active",on:{click:function(t){return e.setCategory(e.parentActive,!0)}}},[e._v("全部")]),e._v(" "),e._l(e.childCategorys,function(t){return s("div",{key:t.categoryid,staticClass:"filter-classify__item",class:e.childActive==t.categoryid&&"active",on:{click:function(s){return e.setCategory(t.categoryid)}}},[e._v(e._s(t.categoryname))])})],2):e._e()]),e._v(" "),s("div",{staticClass:"ks-col-8"},[e.sunCategorys.length?s("div",[s("div",{staticClass:"filter-classify__item",class:e.sunActive==e.childActive&&"active",on:{click:function(t){return e.setCategory(e.childActive,!0)}}},[e._v("全部")]),e._v(" "),e._l(e.sunCategorys,function(t){return s("div",{key:t.categoryid,staticClass:"filter-classify__item",class:e.sunActive==t.categoryid&&"active",on:{click:function(s){return e.setCategory(t.categoryid)}}},[e._v(e._s(t.categoryname))])})],2):e._e()])])]):"types"===e.filterType?s("div",{staticClass:"filter-box"},[s("div",{staticClass:"filter-types"},[s("div",{staticClass:"filter-types__title"},[e._v("价格区间（元）")]),e._v(" "),s("div",{staticClass:"filter-types__list range"},[s("div",{staticClass:"ks-row"},[s("div",{staticClass:"ks-col-11"},[s("ks-input",{ref:"sendreply",attrs:{line:"",type:"number",placeholder:"最低价"},model:{value:e.rangemin,callback:function(t){e.rangemin=t},expression:"rangemin"}})],1),e._v(" "),s("div",{staticClass:"ks-col-2"},[s("i")]),e._v(" "),s("div",{staticClass:"ks-col-11"},[s("ks-input",{ref:"sendreply",attrs:{line:"",type:"number",placeholder:"最高价"},model:{value:e.rangemix,callback:function(t){e.rangemix=t},expression:"rangemix"}})],1)]),e._v(" "),s("div",{staticClass:"ks-row range"},[s("div",{staticClass:"ks-col-8"},[s("span",{class:1==e.rangeType&&"active",on:{click:function(t){e.rangeType=1==e.rangeType?-1:1,e.onrange(e.rangeType)}}},[e._v("0 - 99")])]),e._v(" "),s("div",{staticClass:"ks-col-8"},[s("span",{class:2==e.rangeType&&"active",on:{click:function(t){e.rangeType=2==e.rangeType?-1:2,e.onrange(e.rangeType)}}},[e._v("100 - 199")])]),e._v(" "),s("div",{staticClass:"ks-col-8"},[s("span",{class:3==e.rangeType&&"active",on:{click:function(t){e.rangeType=3==e.rangeType?-1:3,e.onrange(e.rangeType)}}},[e._v("200以上")])])])]),e._v(" "),s("div",{staticClass:"filter-types__title"},[e._v("类型")]),e._v(" "),s("div",{staticClass:"filter-types__list"},[s("div",{staticClass:"ks-row"},[s("div",{staticClass:"ks-col-8"},[s("span",{class:1==e.courseType&&"active",on:{click:function(t){e.courseType=1==e.courseType?-1:1}}},[e._v("点播课程")])]),e._v(" "),s("div",{staticClass:"ks-col-8\n              "},[s("span",{class:2==e.courseType&&"active",on:{click:function(t){e.courseType=2==e.courseType?-1:2}}},[e._v("直播课程")])]),e._v(" "),s("div",{staticClass:"ks-col-8"},[s("span",{class:3==e.courseType&&"active",on:{click:function(t){e.courseType=3==e.courseType?-1:3}}},[e._v("音频课程")])]),e._v(" "),s("div",{staticClass:"ks-col-8"},[s("span",{class:4==e.courseType&&"active",on:{click:function(t){e.courseType=4==e.courseType?-1:4}}},[e._v("图文课程")])]),e._v(" "),s("div",{staticClass:"ks-col-8"},[s("span",{class:5==e.courseType&&"active",on:{click:function(t){e.courseType=5==e.courseType?-1:5}}},[e._v("面授")])]),e._v(" "),s("div",{staticClass:"ks-col-8"},[s("span",{class:6==e.courseType&&"active",on:{click:function(t){e.courseType=6==e.courseType?-1:6}}},[e._v("活动")])])])]),e._v(" "),s("div",{staticClass:"filter-types__title"},[e._v("价格")]),e._v(" "),s("div",{staticClass:"filter-types__list ks-line"},[s("div",{staticClass:"ks-row"},[s("div",{staticClass:"ks-col-8"},[s("span",{class:0==e.chargeType&&"active",on:{click:function(t){e.chargeType=0==e.chargeType?-1:0}}},[e._v("免费")])]),e._v(" "),s("div",{staticClass:"ks-col-8"},[s("span",{class:1==e.chargeType&&"active",on:{click:function(t){e.chargeType=1==e.chargeType?-1:1}}},[e._v("付费")])])])]),e._v(" "),s("div",{staticClass:"filter-types__footer"},[s("ks-button",{staticClass:"ks-fr",attrs:{size:"small",type:"primary"},on:{click:function(t){return e.filter({chargetype:e.chargeType,coursetype:e.courseType,sql_between:[e.rangemin,e.rangemix]})}}},[e._v("确定")]),e._v(" "),s("div",{staticClass:"ks-fl",class:(e.chargeType>-1||e.courseType>-1)&&"cleartj",on:{click:function(t){e.chargeType=-1,e.courseType=-1,e.rangeType=-1,e.rangemix="",e.rangemin=""}}},[e._v("清空筛选")])],1)])]):e._e()])],1),e._v(" "),s("transition",{attrs:{name:"fade"}},[s("div",{directives:[{name:"show",rawName:"v-show",value:""!==e.filterType,expression:"filterType !== ''"}],staticClass:"ks-masked",on:{click:function(t){e.filterType=""}}})]),e._v(" "),e.list.length?s("ks-page-scroll-container",{staticStyle:{"padding-top":"10px",background:"#fff"},attrs:{page:e.p,"page-count":e.pageCount},on:{"page-change":e.getList}},[s("kd-course",{attrs:{"data-type":"course","show-price":"","data-style":e.$store.state.style.course_list_style,"data-list":e.list}})],1):e.loaded?s("ks-empty",{attrs:{msg:"没有找到任何课程~",type:"nogift"}}):e._e(),e._v(" "),s("store-footer-bar")],1)},staticRenderFns:[]};var u=s("C7Lr")(l,y,!1,function(e){s("ySRo")},"data-v-3bcc8dba",null);t.default=u.exports},ySRo:function(e,t){}});