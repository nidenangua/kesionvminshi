webpackJsonp([27],{"9r/T":function(t,e,i){(function(t){var n=void 0!==t&&t||"undefined"!=typeof self&&self||window,s=Function.prototype.apply;function o(t,e){this._id=t,this._clearFn=e}e.setTimeout=function(){return new o(s.call(setTimeout,n,arguments),clearTimeout)},e.setInterval=function(){return new o(s.call(setInterval,n,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(t){t&&t.close()},o.prototype.unref=o.prototype.ref=function(){},o.prototype.close=function(){this._clearFn.call(n,this._id)},e.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},e.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},e._unrefActive=e.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;e>=0&&(t._idleTimeoutId=setTimeout(function(){t._onTimeout&&t._onTimeout()},e))},i("AYvJ"),e.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==t&&t.setImmediate||this&&this.setImmediate,e.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==t&&t.clearImmediate||this&&this.clearImmediate}).call(e,i("9AUj"))},AYvJ:function(t,e,i){(function(t,e){!function(t,i){"use strict";if(!t.setImmediate){var n,s,o,a,c,r=1,d={},l=!1,f=t.document,u=Object.getPrototypeOf&&Object.getPrototypeOf(t);u=u&&u.setTimeout?u:t,"[object process]"==={}.toString.call(t.process)?n=function(t){e.nextTick(function(){h(t)})}:!function(){if(t.postMessage&&!t.importScripts){var e=!0,i=t.onmessage;return t.onmessage=function(){e=!1},t.postMessage("","*"),t.onmessage=i,e}}()?t.MessageChannel?((o=new MessageChannel).port1.onmessage=function(t){h(t.data)},n=function(t){o.port2.postMessage(t)}):f&&"onreadystatechange"in f.createElement("script")?(s=f.documentElement,n=function(t){var e=f.createElement("script");e.onreadystatechange=function(){h(t),e.onreadystatechange=null,s.removeChild(e),e=null},s.appendChild(e)}):n=function(t){setTimeout(h,0,t)}:(a="setImmediate$"+Math.random()+"$",c=function(e){e.source===t&&"string"==typeof e.data&&0===e.data.indexOf(a)&&h(+e.data.slice(a.length))},t.addEventListener?t.addEventListener("message",c,!1):t.attachEvent("onmessage",c),n=function(e){t.postMessage(a+e,"*")}),u.setImmediate=function(t){"function"!=typeof t&&(t=new Function(""+t));for(var e=new Array(arguments.length-1),i=0;i<e.length;i++)e[i]=arguments[i+1];var s={callback:t,args:e};return d[r]=s,n(r),r++},u.clearImmediate=m}function m(t){delete d[t]}function h(t){if(l)setTimeout(h,0,t);else{var e=d[t];if(e){l=!0;try{!function(t){var e=t.callback,n=t.args;switch(n.length){case 0:e();break;case 1:e(n[0]);break;case 2:e(n[0],n[1]);break;case 3:e(n[0],n[1],n[2]);break;default:e.apply(i,n)}}(e)}finally{m(t),l=!1}}}}}("undefined"==typeof self?void 0===t?this:t:self)}).call(e,i("9AUj"),i("V0EG"))},HRxq:function(t,e){},rPAR:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("a3Yh"),s=i.n(n),o=i("/Njs"),a=(i("9r/T"),{components:{MediaPreview:i("T4EX").a},data:function(){var t;return t={minHeight:window.innerHeight,friendDet:{json:{}},friendList:[],publishCom:!1,flag:!0,comcontent:"请输入你的评论",content:"",id:Number,uid:Number},s()(t,"flag",!1),s()(t,"is_teacher",""),s()(t,"comId",""),s()(t,"replyflag",!1),s()(t,"replyuid",""),s()(t,"replyid",""),t},activated:function(){document.title="动态详情",document.addEventListener("click",this.onDocClick),this.getfriendsDet()},deactivated:function(){document.removeEventListener("click",this.onDocClick)},methods:{onDocClick:function(){this.publishCom=!1},getfriendsDet:function(){var t=this;this.$showLoading();var e=this.$route.params.id;Object(o.b)({id:e}).then(function(e){console.log(e),t.friendDet=e.detail,t.friendList=e.list,t.resetJson(t.friendDet.json),t.$hideLoading()}),this.$store.ready(function(e){t.is_teacher=e.userInfo.usertype,t.comId=e.userInfo.userid})},delcom:function(t,e){var i=this;this.$store.ready(function(n){var s=n.userInfo.usertype,a=n.userInfo.userid;s>0?i.$confirm("是否确认删除？").then(function(){Object(o.a)({id:t,type:2}).then(function(t){i.$toast("删除成功"),i.getfriendsDet()})}):a===e&&i.$confirm("是否确认删除？").then(function(){Object(o.a)({id:t,type:2}).then(function(t){i.$toast("删除成功"),i.getfriendsDet()})})})},topicdel:function(t,e){var i=this;this.$store.ready(function(n){var s=n.userInfo.usertype,a=n.userInfo.userid;s>0?i.$confirm("是否确认删除？").then(function(){Object(o.a)({id:t,type:1}).then(function(t){i.$toast("删除成功","success").then(function(){i.$navigateBack()})})}):a===e&&i.$confirm("是否确认删除？").then(function(){Object(o.a)({id:t,type:1}).then(function(t){i.$toast("删除成功","success").then(function(){i.$navigateBack()})})})})},com:function(t){var e=this;event.stopPropagation(),this.flag=!0,this.publishCom=!0,this.comcontent="请输入你的评论",this.$nextTick(function(){e.$refs.sendreply.focus()})},reply:function(t,e,i,n){var s=this;if(this.replyflag=!1,this.flag=!1,this.publishCom=!0,this.$nextTick(function(){s.$refs.sendreply.focus()}),event.stopPropagation(),this.comcontent="回复 : "+e,this.id=i,this.uid=n,this.$store.state.userInfo.userid===this.uid)return this.publishCom=!1,this.$toast("不能自己回复自己哦")},commentpub:function(){var t=this;if(1==this.flag)Object(o.f)({socialid:this.friendDet.id,content:this.content}).then(function(e){t.$toast("评论成功","success"),t.getfriendsDet(),t.content=""});else{if(1==this.replyflag)return void Object(o.f)({socialid:this.friendDet.id,content:this.content,reply_uid:this.reply_uid,parentid:this.id}).then(function(e){t.$toast("评论成功","success"),t.getfriendsDet(),t.content=""});Object(o.f)({socialid:this.friendDet.id,content:this.content,reply_uid:this.uid,parentid:this.id}).then(function(e){t.$toast("评论成功","success"),t.getfriendsDet(),t.content=""})}},dianzan:function(t){var e=this;Object(o.d)({id:t}).then(function(t){e.getfriendsDet()})},resetJson:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};switch(t.$info={},Number(t.type)){case 1:t.$type="image";var e=[];t.info instanceof Array&&t.info.map(function(t){e.push({src:t})}),t.$info={list:e};break;case 2:t.$type="video",t.$info={src:t.info[0]||""};break;case 3:t.$type="audio",t.$info={src:t.info[0]||""}}},handleClose:function(t){this.publishCom=!1},comshow:function(t){event.stopPropagation()},replyreply:function(t,e,i,n){var s=this;if(this.id=n,this.reply_uid=e,console.log(e),this.flag=!1,event.stopPropagation(),this.$store.state.userInfo.userid===e)return this.publishCom=!1,this.$toast("不能自己回复自己哦");this.publishCom=!0,this.$nextTick(function(){s.$refs.sendreply.focus()}),this.comcontent="回复 : "+i,this.replyflag=!0}},watch:{$route:function(t,e){this.$router.go(0)}}}),c={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{style:{minHeight:t.minHeight+"px",background:"#fff"}},[i("div",{staticClass:"friend"},[i("div",{staticClass:"friend-name"},[t._v(t._s(t.friendDet.name))]),t._v(" "),i("p",{staticClass:"friend-time"},[t._v(t._s(t.friendDet.adddate))]),t._v(" "),i("ks-image",{staticClass:" friend-head",attrs:{src:t.friendDet.head}}),t._v(" "),i("p",{staticClass:"friend-content"},[t._v(t._s(t.friendDet.json.content))]),t._v(" "),i("media-Preview",{attrs:{type:t.friendDet.json.$type,info:t.friendDet.json.$info}}),t._v(" "),i("div",{staticClass:"friend-tool"},[t.is_teacher>0?i("span",{staticClass:"friend-tool__delete",on:{click:function(e){return t.topicdel(t.friendDet.id,t.friendDet.userid)}}},[t._v("删除")]):t._e(),t._v(" "),i("span",{staticClass:"friend-tool__comment",on:{click:function(e){return t.com(e)}}},[i("i",{staticClass:"ks-icon ks-icon-message-square-outline"}),t._v("\n        "+t._s(t.friendDet.reply_num)+"\n      ")]),t._v(" "),i("span",{staticClass:"friend-tool__like",on:{click:function(e){return t.dianzan(t.friendDet.id)}}},[t.friendDet.is_zan?i("i",{staticClass:"ks-icon ks-icon-dianzan"}):i("i",{staticClass:"ks-icon ks-icon-dianzan-outline"}),t._v("\n        "+t._s(t.friendDet.zan_num)+"\n      ")])])],1),t._v(" "),i("div",{staticClass:"clearfix"}),t._v(" "),i("div",{staticClass:"gridClass"}),t._v(" "),t._l(t.friendList,function(e,n){return i("div",{directives:[{name:"show",rawName:"v-show",value:n<4||t.flag,expression:"i < 4 || flag"}],key:e.id,staticClass:"friend"},[i("div",{staticClass:"friend-name"},[t._v(t._s(e.name))]),t._v(" "),i("p",{staticClass:"friend-time"},[t._v(t._s(e.adddate))]),t._v(" "),i("ks-image",{staticClass:" friend-head",attrs:{src:e.head}}),t._v(" "),i("p",{staticClass:"friend-content"},[t._v(t._s(e.json))]),t._v(" "),i("div",{staticClass:"critic-tool"},[i("span",{staticClass:"critic",on:{click:function(i){return t.reply(i,e.name,e.id,e.userid)}}},[t._v("回复")]),t._v(" "),t.is_teacher>0||t.comId==e.userid?i("span",{staticClass:"critic-tool__delete",on:{click:function(i){return t.delcom(e.id,e.userid)}}},[t._v("删除")]):t._e()]),t._v(" "),t._l(e.reply_list,function(n){return i("div",{key:n.id,staticClass:"comment"},[i("div",{staticClass:"friend"},[i("div",{staticClass:"friend-name"},[i("span",[t._v(t._s(n.name))]),t._v("  回复  "),i("span",[t._v(t._s(n.reply_name))])]),t._v(" "),i("p",{staticClass:"friend-time"},[t._v(t._s(n.adddate))]),t._v(" "),i("ks-image",{staticClass:" friend-head",attrs:{src:n.head}}),t._v(" "),i("p",{staticClass:"friend-content"},[t._v(t._s(n.json))]),t._v(" "),i("div",{staticClass:"critic-tool"},[i("span",{staticClass:"critic",on:{click:function(i){return t.replyreply(i,n.userid,n.name,e.id)}}},[t._v("回复")]),t._v(" "),t.is_teacher>0||t.comId==n.userid?i("span",{staticClass:"critic-tool__delete",on:{click:function(e){return t.delcom(n.id,n.userid)}}},[t._v("删除")]):t._e()]),t._v(" "),i("div",{staticClass:"gridClass"})],1)])})],2)}),t._v(" "),i("div",{staticClass:"gridClass"}),t._v(" "),t.friendList.length>4?i("div",{staticClass:"more"},[t.flag?i("a",{staticClass:"more-reply"},[t._v("已经显示全部回复")]):i("a",{staticClass:"more-reply",on:{click:function(e){t.flag=!t.flag}}},[t._v("加载更多回复")])]):t._e(),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:t.publishCom,expression:"publishCom"}],staticClass:"publish",on:{click:function(e){return t.comshow(e)}}},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.content,expression:"content"}],ref:"sendreply",attrs:{type:"text",placeholder:t.comcontent},domProps:{value:t.content},on:{input:function(e){e.target.composing||(t.content=e.target.value)}}}),t._v(" "),i("button",{on:{click:t.commentpub}},[t._v("发送")])]),t._v(" "),i("store-footer")],2)},staticRenderFns:[]};var r=i("C7Lr")(a,c,!1,function(t){i("HRxq")},"data-v-0656fd8c",null);e.default=r.exports}});