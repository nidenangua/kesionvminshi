webpackJsonp([52],{"/uXy":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s,a=i("rVsN"),c=i.n(a),r=i("ZLEe"),n=i.n(r),o=i("a3Yh"),l=i.n(o),u=i("0xDb"),d=i("6L+O"),v=[],y={name:"MallList",data:function(){var t;return t={loaded:!1,filterType:"",pageCount:null},l()(t,"filterType",""),l()(t,"p",1),l()(t,"list",[]),l()(t,"params",""),l()(t,"categoryName",""),l()(t,"parentActive",0),l()(t,"parentCategorys",[]),l()(t,"childActive",0),l()(t,"childCategorys",[]),l()(t,"sunActive",0),l()(t,"sunCategorys",[]),t},watch:{"$route.query":{handler:function(){this.getList()},deep:!0}},mounted:function(){var t=this;Object(d.k)().then(function(e){t.parentCategorys=e,t.addCategory(e),t.setCategory(t.$route.query.categoryid,!0)})},methods:(s={jumpCart:function(){this.$router.push("/cart")},addCategory:function(t,e){var i=this,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;t.map(function(t){e&&(t.parent=e),t.level=s,v.push(t),t.child&&s<2&&i.addCategory(t.child,t,s+1)})},setCategory:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments[1];0==e?(this.parentActive=0,this.childActive=0,this.childCategorys=[],this.sunActive=0,this.sunCategorys=[],this.categoryName="选择分类",this.filter({categoryid:"0"})):v.map(function(s){s.categoryid==e&&(0===s.level?(t.parentActive=s.categoryid,t.childActive=s.categoryid,t.childCategorys=s.child||[],t.sunActive=0,t.sunCategorys=[]):1===s.level?(t.parentActive=s.parent.categoryid,t.childCategorys=s.parent.child,t.childActive=s.categoryid,t.sunActive=s.categoryid,t.sunCategorys=s.child||[]):2===s.level&&(t.parentActive=s.parent.parent.categoryid,t.childCategorys=s.parent.parent.child,t.childActive=s.parent.categoryid,t.sunActive=s.categoryid,t.sunCategorys=s.parent.child),s.child&&!i&&2!==s.level||(t.categoryName=s.categoryname,t.filter({categoryid:s.categoryid})))})},open:function(t){this.$router.push("/commodity?id="+t)},goSearch:function(t){this.params=t,this.resetParams(),this.getList()},resetParams:function(t){t=t||{},this.pageCount=t.pageCount||null,this.params.p=t.p||1,this.list=t.list||[]}},l()(s,"addCategory",function(t,e){var i=this,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;t.map(function(t){e&&(t.parent=e),t.level=s,v.push(t),t.child&&s<2&&i.addCategory(t.child,t,s+1)})}),l()(s,"filter",function(t){var e=Object(u.a)(this.$route.query);n()(t).map(function(i){e[i]=t[i]}),this.$router.push({name:this.$route.name,query:e}),this.filterType=""}),l()(s,"getList",function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return new c.a(function(i){t.$showLoading(),t.p=e,1==e&&(t.list=[]);var s={keyword:t.$route.query.key,p:e,maxperpage:10};t.$route.query.categoryid>0&&(s.categoryid=t.$route.query.categoryid),t.$route.query.rank>0&&(s.rank=t.$route.query.rank),Object(d.l)(s).then(function(s){t.list=1==e?s.list:t.list.concat(s.list),t.pageCount=s.page.total_pages,t.loaded=!0,t.$hideLoading(),i(s)})})}),s),activated:function(){document.title="商品列表",this.getList()}},f={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("div",{staticClass:"search",on:{click:function(e){t.filterType=""}}},[i("kd-search")],1),t._v(" "),i("div",{staticClass:"filter"},[i("div",{staticClass:"filter-header ks-row ks-line"},[i("div",{staticClass:"ks-col-12",class:"sort"===t.filterType&&"active",on:{click:function(e){t.filterType="sort"===t.filterType?"":"sort"}}},[t._v("\n        "+t._s((2==t.$route.query.rank?"销量排序":3==t.$route.query.rank&&"价格最低")||4==t.$route.query.rank&&"价格最高"||"最新排序")+"\n        "),i("i",{staticClass:"ks-icon ks-icon-chevron-down"})]),t._v(" "),i("div",{staticClass:"ks-col-12",class:"classify"===t.filterType&&"active",on:{click:function(e){t.filterType="classify"===t.filterType?"":"classify"}}},[t._v("\n        "+t._s(t.categoryName)+"\n        "),i("i",{staticClass:"ks-icon ks-icon-chevron-down"})])]),t._v(" "),i("transition",{attrs:{name:"fade-up"}},["sort"===t.filterType?i("div",{staticClass:"filter-box"},[i("div",{staticClass:"filter-classify__item",on:{click:function(e){return t.filter({rank:"1"})}}},[t._v("最新排序")]),t._v(" "),i("div",{staticClass:"filter-classify__item",on:{click:function(e){return t.filter({rank:"2"})}}},[t._v("销量排序")]),t._v(" "),i("div",{staticClass:"filter-classify__item",on:{click:function(e){return t.filter({rank:"3"})}}},[t._v("价格最低")]),t._v(" "),i("div",{staticClass:"filter-classify__item",on:{click:function(e){return t.filter({rank:"4"})}}},[t._v("价格最高")])]):"classify"===t.filterType?i("div",{staticClass:"filter-box"},[i("div",{staticClass:"filter-classify ks-row"},[i("div",{staticClass:"ks-col-8"},[i("div",{staticClass:"filter-classify__item",class:0==t.parentActive&&"active",on:{click:function(e){return t.setCategory("0")}}},[t._v("全部")]),t._v(" "),t._l(t.parentCategorys,function(e){return i("div",{key:e.categoryid,staticClass:"filter-classify__item",class:t.parentActive==e.categoryid&&"active",on:{click:function(i){return t.setCategory(e.categoryid)}}},[t._v(t._s(e.categoryname))])})],2),t._v(" "),i("div",{staticClass:"ks-col-8"},[t.childCategorys.length?i("div",[i("div",{staticClass:"filter-classify__item",class:t.childActive==t.parentActive&&"active",on:{click:function(e){return t.setCategory(t.parentActive,!0)}}},[t._v("全部")]),t._v(" "),t._l(t.childCategorys,function(e){return i("div",{key:e.categoryid,staticClass:"filter-classify__item",class:t.childActive==e.categoryid&&"active",on:{click:function(i){return t.setCategory(e.categoryid)}}},[t._v(t._s(e.categoryname))])})],2):t._e()]),t._v(" "),i("div",{staticClass:"ks-col-8"},[t.sunCategorys.length?i("div",[i("div",{staticClass:"filter-classify__item",class:t.sunActive==t.childActive&&"active",on:{click:function(e){return t.setCategory(t.childActive,!0)}}},[t._v("全部")]),t._v(" "),t._l(t.sunCategorys,function(e){return i("div",{key:e.categoryid,staticClass:"filter-classify__item",class:t.sunActive==e.categoryid&&"active",on:{click:function(i){return t.setCategory(e.categoryid)}}},[t._v(t._s(e.categoryname))])})],2):t._e()])])]):t._e()])],1),t._v(" "),i("transition",{attrs:{name:"fade"}},[i("div",{directives:[{name:"show",rawName:"v-show",value:""!==t.filterType,expression:"filterType !== ''"}],staticClass:"ks-masked",on:{click:function(e){t.filterType=""}}})]),t._v(" "),t.list.length?i("ks-page-scroll-container",{attrs:{page:t.p,"page-count":t.pageCount},on:{"page-change":t.getList}},[i("div",{staticClass:"ks-row malist"},t._l(t.list,function(e,s){return i("div",{key:s,staticClass:"ks-col-12 ks-pr-10 shopdel",on:{click:function(i){return t.open(e.courseid)}}},[i("ks-image",{staticStyle:{height:"180px"},attrs:{src:e.defaultpic}}),t._v(" "),i("div",{staticClass:"malist-title"},[t._v(t._s(e.title.substring(0,20))),e.title.length>20?i("a",[t._v("...")]):t._e()]),t._v(" "),i("span",{staticClass:"malist-price"},[t._v("￥"+t._s(e.price))]),i("span",{staticClass:"ks-fr malist-people"},[t._v(t._s(e.studentcount)+"人购买")])],1)}),0)]):t.loaded?i("ks-empty",{attrs:{msg:"没有找到任何课程~",type:"nogift"}}):t._e(),t._v(" "),i("div",{staticClass:"malist-icon"},[i("i",{staticClass:"ks-icon ks-icon-shopping-cart",on:{click:function(e){return t.jumpCart()}}})]),t._v(" "),i("store-footer")],1)},staticRenderFns:[]};var g=i("C7Lr")(y,f,!1,function(t){i("5Csk")},"data-v-eb9b27ea",null);e.default=g.exports},"5Csk":function(t,e){}});