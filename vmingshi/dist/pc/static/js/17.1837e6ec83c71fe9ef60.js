webpackJsonp([17],{"2lZk":function(t,s){},"4VDt":function(t,s,e){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var i=e("vMJZ"),a={name:"OrderPopup",props:{ordersn:String,visible:Boolean},data:function(){return{loaded:!1,info:{},values:[]}},watch:{ordersn:function(){this.getDetail()}},mounted:function(){this.getDetail()},methods:{handleClose:function(){this.$emit("update:visible",!1)},getDetail:function(){var t=this;this.loaded=!1,Object(i.k)({ordersn:this.ordersn}).then(function(s){t.info=s.info,t.values=s.values,t.loaded=!0})}}},n={render:function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("el-dialog",{attrs:{title:"订单详情",visible:t.visible,width:"826px","before-close":t.handleClose,center:""},on:{"update:visible":function(s){t.visible=s}}},[e("div",{class:!t.loaded&&"orderPopup--noopacity"},[e("div",{staticClass:"orderPopup-box"},[e("div",{staticClass:"orderPopup-date"},[e("span",[t._v("下单时间："+t._s(t.info.adddate))]),t._v(" "),e("span",[t._v("订单编号："+t._s(t.info.ordersn))])]),t._v(" "),e("div",{staticClass:"orderPopup-order"},[e("div",{staticClass:"orderPopup-subTitle"},[e("div",{staticClass:"orderPopup-subTitle__goods"},[t._v("商品")]),t._v(" "),e("div",{staticClass:"orderPopup-subTitle__price"},[t._v("价格")]),t._v(" "),e("div",{staticClass:"orderPopup-subTitle__state"},[t._v("状态")])]),t._v(" "),t._l(t.values,function(s,i){return e("div",{key:i,staticClass:"orderPopup-order__box"},[e("div",{staticClass:"orderPopup-order__goods"},[e("ks-image",{attrs:{src:s.defaultpic,fit:"cover"}}),t._v(" "),e("div",{staticClass:"orderPopup-order__right"},[e("h1",[t._v(t._s(s.title))]),t._v(" "),0==s.type&&1==s.coursetype?e("span",[t._v("点播课程")]):0==s.type&&2==s.coursetype?e("span",[t._v("直播课程")]):0==s.type&&3==s.coursetype?e("span",[t._v("音频课程")]):0==s.type&&4==s.coursetype?e("span",[t._v("图文课程")]):7==s.type?e("span",[t._v("专栏")]):10==s.type?e("span",[t._v("社群")]):11==s.type?e("span",[t._v("资料")]):15==s.type||14==s.type?e("span",[t._v("教辅周边 "),e("span",{staticStyle:{float:"right"}},[t._v("X"+t._s(s.numb))])]):t._e()])],1),t._v(" "),e("div",{staticClass:"orderPopup-order__price"},[t._v("￥"+t._s(s.price))]),t._v(" "),14!=t.info.type&&15!=t.info.type||0==t.info.paystatus?e("div",{staticClass:"orderPopup-order__state"},[t._v("\n              "+t._s((0==t.info.paystatus?"待付款":1==t.info.paystatus&&"已付款")||2==t.info.paystatus&&"退款中"||3==t.info.paystatus&&"已退款")+"\n          ")]):14!=s.type&&15!=s.type||1!=s.paystatus?t._e():e("div",{staticClass:"orderPopup-order__state"},[t._v("\n              "+t._s((0==t.info.orderstatus?"待发货":1==t.info.orderstatus&&"待收货")||2==t.info.orderstatus&&"已收货")+"\n          ")])])})],2)]),t._v(" "),e("div",{staticClass:"orderPopup-detail"},[14==t.info.type||15==t.info.type?e("div",{staticClass:"orderPopup-detail__item"},[e("span",[t._v("￥"+t._s(t.info.json.address_info.freight))]),t._v(" "),e("p",[t._v("运费：")])]):t._e(),t._v(" "),e("div",{staticClass:"orderPopup-detail__item"},[e("span",[t._v("￥"+t._s(t.info.original_amount?t.info.original_amount:"0.00"))]),t._v(" "),e("p",[t._v("总金额：")])]),t._v(" "),null!==t.info.discount?e("div",{staticClass:"orderPopup-detail__item"},[e("span",[t._v(t._s(t.info.discount+"折"))]),t._v(" "),e("p",[t._v("会员折扣：")])]):e("div",{staticClass:"orderPopup-detail__item"},[e("span",[t._v("无折扣")]),t._v(" "),e("p",[t._v("会员折扣：")])]),t._v(" "),e("div",{staticClass:"orderPopup-detail__item"},[e("span",[t._v("-￥"+t._s(t.info.vouchermoney||"0.00"))]),t._v(" "),e("p",[t._v("优惠券：")])]),t._v(" "),e("div",{staticClass:"orderPopup-detail__item"},[e("span",[t._v("￥"+t._s(t.info.order_amount))]),t._v(" "),e("p",[t._v("实际支付金额：")])])]),t._v(" "),e("div",{staticClass:"orderPopup-detail__retrun"},[e("span",{on:{click:t.handleClose}},[t._v("返回")])])])])},staticRenderFns:[]};var r=e("C7Lr")(a,n,!1,function(t){e("2lZk")},"data-v-ce9ec978",null).exports,o=e("0xDb"),d={data:function(){return{hasToken:-1,page:1,pageCount:null,paystatus:-1,orderstatus:-1,loaded:!1,datas:[],refund:!1,tel:"",wechat:"",tuikuanindex:-1}},methods:{changeTab:function(t){3==t&&(this.orderstatus=1,this.paystatus=3),4==t&&(this.orderstatus=2,this.paystatus=4),-1!=t&&1!=t&&2!=t||(this.paystatus=t,this.orderstatus=-1),this.pageCount=null,this.loaded=!1,this.getOrderList()},delorder:function(t,s){var e=this;this.$confirm("确定要删除该订单吗？","提示",{type:"warning"}).then(function(){var a={ordersn:s},n=Object(o.c)();n.h5token&&(a.h5token=n.h5token),Object(i.e)(a).then(function(s){e.$toast(s.msg,"success").then(function(){e.datas.splice(t,1)})})})},confirmReceip:function(t,s){var e=this;this.$confirm("确定要确认收货吗？","提示",{type:"warning"}).then(function(){var a={ordersn:s};Object(i.d)(a).then(function(s){e.$toast(s.msg,"success").then(function(){e.datas.splice(t,1)})})})},open:function(t){location.href=t},openView:function(t,s){if(9!=t.type){var e=Object(o.e)(t,"courseid");location.href=s+"/#"+e}},chakanDetail:function(t){this.$router.push({name:"UserOrderInfo",params:{id:t}})},pay:function(t){location.href=t},getOrderList:function(){var t=this,s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.$showLoading(),this.page=s;var e={paystatus:this.paystatus,orderstatus:this.orderstatus,p:this.page,maxperpage:10},a=Object(o.c)();a.h5token?(e.h5token=a.h5token,this.hasToken=1):this.hasToken=0,Object(i.m)(e).then(function(s){t.datas=s.values,t.pageCount=10*s.page.total_pages,t.loaded=!0,t.$hideLoading()})}}},p=e("6L+O"),c={name:"MyOrder",components:{OrderPopup:r},mixins:[d],data:function(){return{dialogVisible:!1,tab:-1,visible:!1,ordersn:null,reverse:!0,activities:[],info:[],message:""}},methods:{showLog:function(t){var s=this;Object(p.k)({ordersn:t}).then(function(t){s.info=t.info,s.info.title=t.info.title.substring(0,5),s.activities=t.data,s.message=t.message}),this.dialogVisible=!0},popup:function(t){this.ordersn=t,this.visible=!0},open:function(t){1==t.type?this.$router.push({name:"CourseDetail",params:{id:t.courseid}}):7==t.type?this.$router.push({name:"ColumnDetail",params:{id:t.columnid}}):14!=t.type&&15!=t.type||this.$router.push("/commodity?id="+t.courseid)}},mounted:function(){this.getOrderList()}},_={render:function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",[e("div",{staticClass:"myOrder"},[e("div",{staticClass:"myOrder-top"},[e("h1",[t._v("我的订单")]),t._v(" "),e("div",{staticClass:"myOrder-top__box"},[e("div",{staticClass:"myOrder-top__tab"},[e("span",{class:{active:-1==t.paystatus},on:{click:function(s){return t.changeTab(-1)}}},[t._v("全部")]),t._v(" "),e("span",{class:{active:2==t.paystatus},on:{click:function(s){return t.changeTab(2)}}},[t._v("待支付")]),t._v(" "),e("span",{class:{active:1==t.paystatus},on:{click:function(s){return t.changeTab(1)}}},[t._v("已付款")]),t._v(" "),e("span",{class:{active:3==t.paystatus},on:{click:function(s){return t.changeTab(3)}}},[t._v("待收货")]),t._v(" "),e("span",{class:{active:4==t.paystatus},on:{click:function(s){return t.changeTab(4)}}},[t._v("已收货")])])])]),t._v(" "),e("div",{staticClass:"myOrder-main"},[t._m(0),t._v(" "),t._l(t.datas,function(s,i){return e("div",{key:i,staticClass:"myOrder-list"},[e("div",{staticClass:"myOrder-list__top"},[e("span",[t._v("下单时间："+t._s(s.adddate))]),t._v(" "),e("p",[t._v("订单编号："+t._s(s.ordersn))])]),t._v(" "),t._l(s.courseOrder,function(s,i){return e("div",{key:i,staticClass:"myOrder-list__bottom"},[e("div",{staticClass:"myOrder-list__goods"},[e("ks-image",{attrs:{src:s.defaultpic},on:{click:function(e){return t.open(s)}}}),t._v(" "),e("div",{staticClass:"myOrder-list__right"},[e("h1",{on:{click:function(e){return t.open(s)}}},[t._v(t._s(s.title))]),t._v(" "),0==s.type&&1==s.coursetype?e("span",[t._v("点播课程")]):0==s.type&&2==s.coursetype?e("span",[t._v("直播课程")]):0==s.type&&3==s.coursetype?e("span",[t._v("音频课程")]):0==s.type&&4==s.coursetype?e("span",[t._v("图文课程")]):7==s.type?e("span",[t._v("专栏")]):9==s.type?e("span",[t._v("会员卡")]):10==s.type?e("span",[t._v("社群")]):11==s.type?e("span",[t._v("资料")]):e("span",[t._v(t._s(s.buytype))])])],1)])}),t._v(" "),e("div",{staticClass:"order_list"},[e("div",{staticClass:"myOrder-list__price"},[t._v("￥"+t._s(s.order_amount))]),t._v(" "),e("i"),t._v(" "),14!=s.type&&15!=s.type||0==s.paystatus?e("div",{staticClass:"myOrder-list__state"},[t._v(t._s((0==s.paystatus?"待付款":1==s.paystatus&&"已付款")||2==s.paystatus&&"退款中"||3==s.paystatus&&"已退款"))]):14!=s.type&&15!=s.type||1!=s.paystatus?t._e():e("div",{staticClass:"myOrder-list__state"},[t._v(t._s((0==s.orderstatus?"待发货":1==s.orderstatus&&"待收货")||2==s.orderstatus&&"已收货"))]),t._v(" "),e("i"),t._v(" "),1==s.paystatus?e("div",{staticClass:"myOrder-list__operate"},[e("span",{on:{click:function(e){return t.popup(s.ordersn)}}},[t._v("订单详情")]),t._v(" "),1==s.orderstatus||2==s.orderstatus?e("span",{on:{click:function(e){return t.showLog(s.ordersn)}}},[t._v("查看物流")]):t._e(),t._v(" "),1==s.orderstatus?e("span",{staticClass:"order__take",on:{click:function(e){return t.confirmReceip(i,s.ordersn)}}},[t._v("确认收货")]):t._e()]):0==s.paystatus?e("div",{staticClass:"myOrder-list__nopay"},[e("el-button",{attrs:{size:"medium",type:"warning"},on:{click:function(e){return t.$pay(s.qrcode,s.ordersn,s.order_amount)}}},[t._v("立即支付")]),t._v(" "),e("p",{on:{click:function(e){return t.delorder(i,s.ordersn)}}},[t._v("删除订单")]),t._v(" "),14==s.type||15==s.type?e("p",{on:{click:function(e){return t.popup(s.ordersn)}}},[t._v("订单详情")]):t._e()],1):t._e()])],2)}),t._v(" "),e("div",{staticStyle:{"text-align":"center"}},[t.pageCount>0?e("el-pagination",{attrs:{background:"",layout:"prev, pager, next",total:t.pageCount},on:{"current-change":t.getOrderList}}):e("ks-empty",{attrs:{msg:"该分类暂无订单"}})],1)],2)]),t._v(" "),e("el-dialog",{attrs:{title:"查看物流",visible:t.dialogVisible,width:"35%",center:!0},on:{"update:visible":function(s){t.dialogVisible=s}}},[e("div",{staticClass:"showlog__hx"}),t._v(" "),e("div",{staticClass:"showlog"},[t._v(" 下单时间:"+t._s(t.info.adddate)+"      物流快递:"+t._s(t.info.logistics)+"      快递单号:"+t._s(t.info.expressNumber))]),t._v(" "),e("span",[e("el-timeline",{attrs:{reverse:t.reverse}},t._l(t.activities,function(s,i){return e("el-timeline-item",{key:i,attrs:{timestamp:s.context}},[t._v(t._s(s.time))])}),1),t._v(" "),"ok"!=t.message?e("a",{staticStyle:{"margin-left":"40%"}},[t._v("还没有物流信息")]):t._e()],1),t._v(" "),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(s){t.dialogVisible=!1}}},[t._v("取 消")]),t._v(" "),e("el-button",{attrs:{type:"primary"},on:{click:function(s){t.dialogVisible=!1}}},[t._v("确 定")])],1)]),t._v(" "),t.ordersn?e("order-popup",{attrs:{visible:t.visible,ordersn:t.ordersn},on:{"update:visible":function(s){t.visible=s}}}):t._e()],1)},staticRenderFns:[function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"myOrder-title"},[s("div",{staticClass:"myOrder-title__goods"},[this._v("商品")]),this._v(" "),s("div",{staticClass:"myOrder-title__price"},[this._v("合计金额")]),this._v(" "),s("div",{staticClass:"myOrder-title__state"},[this._v("状态")]),this._v(" "),s("div",{staticClass:"myOrder-title__operate"},[this._v("操作")])])}]};var u=e("C7Lr")(c,_,!1,function(t){e("cZll")},"data-v-4cb3e991",null);s.default=u.exports},cZll:function(t,s){}});